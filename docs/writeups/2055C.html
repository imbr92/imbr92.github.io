<!DOCTYPE html>
<html lang="en">
<head>
    <title>2055C</title>
    <link rel="stylesheet" href="https://latex.now.sh/style.css">
    <link rel='stylesheet' type='text/css' href="style.css">
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [["$", "$"]]
            }
        }
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <meta charset="utf-8"/>
</head>
<body>

<h3>C. The Trail</h3>
<h5>Abridged Statement</h5>
<p>
    You are given an $n \times m$ grid $A$ where all but $n + m - 1$ cells have an integer written in them. The $n + m - 1$ cells that are blank form a path from the top left corner to the bottom right corner which moves strictly via downward or rightward steps. Your task is to fill in the blank cells (forming a grid $B$) such that each row and column sums to the same value, or say that it is impossible.
</p>
<h5>Constraints</h5>
<p>
            \[ 1 \leq t \leq 10^4 \]
            \[ 2 \leq n, m \leq 1000 \]
            \[ -10^6 \leq A_{i, j} \leq 10^6 \text{ for all } i, j\]
            \[ -10^{15} \leq B_{i, j} \leq 10^{15} \text{ for all } i, j\]
            \[ \text{Time Limit: } 2 \text{ sec}\]
            \[ \text{Memory Limit: } 256 \text{ MB} \]
</p>

<h5>Analysis</h5>
<p>
            This is a system of linear equations, where we have $n + m$ unknowns and $n + m$ equations. Specifically, our unknowns are the $n + m - 1$ blank cells and the target sum $T = \sum_j A_{x, j} = \sum_i A_{i, y}$ for any $x, y$. Note that Gaussian Elimination is far too slow here.

</p>

<p>
    Observations
</p>

<ol>
    <li>
        \[nT = \sum_x T = \sum_x \sum_j A_{x, j} = \sum_y \sum_i A_{i, y} = \sum_y T = mT\]

                so if $n \neq m$, the target sum is either $0$, or it is impossible to fill the grid.
    </li>
    <li>
        Once we know a target sum to try, we can simply solve this inductively, filling in a corner at each step. WLOG, choose $A_{0, 0}$. It is either the only blank in its row or the only blank in its column, so given the target sum, we can uniquely determine it's value and induct on the next step in the path.
    </li>
    <li>
        Once we have a target sum, by (2), we know that all numbers are completely determined through an iterative process. In that process, if we are not on the final blank that needs to be filled in, then exactly one of the row/col of the current blank cell has no other blanks. This means that the only time we can possibly get a contradiction with our filling method is in the final cell. WLOG assume the final cell is $(n - 1, m - 1)$. Then the sum of all elements in row $n - 1$ is the same as $(m - 1) T - \sum_{i = 0}^{n - 2} \sum_{j = 0}^{m - 2} B_{i, j}$ and similarly, the sum of all elements in column $m - 1$ is $(n - 1) T - \sum_{i = 0}^{n - 2} \sum _{j = 0}^{m - 2} B_{i, j}$. Obviously, if $T = 0$, this is always true, proving that a solution always exists regardless of whether $n = m$ or not. 

    </li>
    <li>
        Note that (1) is not actually necessary since (3) is strictly stronger.
    </li>
</ol>



</body>
</html>
